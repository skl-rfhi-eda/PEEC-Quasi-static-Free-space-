#include "Gaussion.h"


//一维高斯 - 勒让德积分数据
std::array<std::array<double, 10>, 10> AK; //权重
std::array<std::array<double, 10>, 10> NK;  //高斯点

std::array<std::array<double, 10>, 10> U_NK;
std::array<std::array<double, 10>, 10> S_NK;
std::array<std::array<double, 10>, 10> Q_NK;

// W_NK类型的数组
std::array<W_NK, 10> T_AK;

// 三角形高斯积分参数
std::array<std::array<std::array<double, 3>, 25>, 10> SG;  // 10x25x3
std::array<std::array<double, 25>, 10> SW;                 // 10x25
std::array<int, 10> SN;                                     // 10

// 四面体高斯积分参数
std::array<std::array<std::array<double, 4>, 15>, 5> VG;   // 5x15x4
std::array<std::array<double, 15>, 5> VW;                  // 5x15
std::array<int, 7> VN;                                      // 7


// 矩形高斯积分参数
std::array<int, 10> RN;
//std::vector<std::vector<std::vector<double>>> RG;
std::vector<std::vector<std::array<double, 2>>> RG;
std::vector<std::vector<double>> RW;


// 动态数组
std::vector<std::vector<std::vector<double>>> SG_C;
std::vector<std::vector<double>> SW_C;
std::vector<int> SN_C;


// 初始化所有数组数据
void initialize_arrays() {

    // 初始化矩形1D高斯点和权重数据
    AK[0] = { 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    AK[1] = { 1.00000000, 1.00000000, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    AK[2] = { 0.5555555556, 0.8888888888, 0.5555555556, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    AK[3] = { 0.3478548451, 0.6521451549, 0.6521451549, 0.3478548451, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    AK[4] = { 0.2369268851, 0.4786286705, 0.5688888888, 0.4786286705, 0.2369268851, 0.0, 0.0, 0.0, 0.0, 0.0 };
    AK[5] = { 0.1713244924, 0.3607615730, 0.4679139346, 0.4679139346, 0.3607615730, 0.1713244924, 0.0, 0.0, 0.0, 0.0 };
    AK[6] = { 0.1294849662, 0.2797053915, 0.3818300505, 0.4179591837, 0.3818300505, 0.2797053915, 0.1294849662, 0.0, 0.0, 0.0 };
    AK[7] = { 0.1012285363, 0.2223810345, 0.3137066459, 0.3626837834, 0.3626837834, 0.3137066459, 0.2223810345, 0.1012285363, 0.0, 0.0 };
    AK[8] = { 0.081274389, 0.180648161, 0.260610696, 0.312347077, 0.330239355, 0.312347077, 0.260610696, 0.180648161, 0.081274389, 0.0 };
    AK[9] = { 0.06667134, 0.14945135, 0.21908636, 0.26926672, 0.29552422, 0.29552422, 0.26926672, 0.21908636, 0.14945135, 0.06667134 };
    // Initialize NK array
    NK[0] = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    NK[1] = { -0.5773502692, 0.5773502692, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    NK[2] = { -0.7745966692, 0.0, 0.7745966692, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    NK[3] = { -0.8611363116, -0.3399810436, 0.3399810436, 0.8611363116, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    NK[4] = { -0.9061798459, -0.5384693101, 0.0, 0.5384693101, 0.9061798459, 0.0, 0.0, 0.0, 0.0, 0.0 };
    NK[5] = { -0.9324695142, -0.6612093865, -0.2386191861, 0.2386191861, 0.6612093865, 0.9324695142, 0.0, 0.0, 0.0, 0.0 };
    NK[6] = { -0.9491079123, -0.7415311856, -0.4058451514, 0.0, 0.4058451514, 0.7415311856, 0.9491079123, 0.0, 0.0, 0.0 };
    NK[7] = { -0.9602898565, -0.7966664774, -0.5255324099, -0.1834346425, 0.1834346425, 0.5255324099, 0.7966664774, 0.9602898565, 0.0, 0.0 };
    NK[8] = { -0.9681602395, -0.836031107, -0.6133714327, -0.3242534234, 0.0, 0.3242534234, 0.6133714327, 0.836031107, 0.9681602395, 0.0 };
    NK[9] = { -0.97390653, -0.86506337, -0.67940957, -0.43339539, -0.14887434, 0.14887434, 0.43339539, 0.67940957, 0.86506337, 0.97390653 };

    // -- - 矩形数据(预计算并存储) -- -
    RN = { 1, 4, 9, 16, 25, 36, 49, 64, 81, 100 };
    RG.resize(10);
    RW.resize(10);
    for (int order_idx = 0; order_idx < 10; ++order_idx) {
        int n_pts_1d = order_idx + 1;
        int num_total_points = n_pts_1d * n_pts_1d;
        RG[order_idx].resize(num_total_points);
        RW[order_idx].resize(num_total_points);

        int count = 0;
        for (int i = 0; i < n_pts_1d; ++i) { // y-axis
            for (int j = 0; j < n_pts_1d; ++j) { // x-axis
                RG[order_idx][count][0] = NK[order_idx][j];
                RG[order_idx][count][1] = NK[order_idx][i];
                RW[order_idx][count] = AK[order_idx][j] * AK[order_idx][i];
                count++;
            }
        }
    } //


    // Initialize SN array
    SN = { 1, 3, 4, 6, 7, 12, 13, 16, 19, 25 };

    // Initialize SG array
    SG[0][0][0] = 0.3333333333;
    SG[0][0][1] = 0.3333333333;
    SG[0][0][2] = 0.3333333333;
    SW[0] = { 1.0 };

    // SG(2,1:3,1-3) ,SW(2,1:3)
    double sg2[3][3] = {
        {0.6666666667, 0.1666666667, 0.1666666667},
        {0.1666666667, 0.6666666667, 0.1666666667},
        {0.1666666667, 0.1666666667, 0.6666666667}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 3; j++) SG[1][j][k] = sg2[k][j];
    }
    SW[1] = { 0.3333333333, 0.3333333333, 0.3333333333 };

    // SG(3,1:4,1-3), SW(3,1:4)
    double sg3[3][4] = {
        {0.3333333333, 0.6, 0.2, 0.2},
        {0.3333333333, 0.2, 0.6, 0.2},
        {0.3333333333, 0.2, 0.2, 0.6}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 4; j++) SG[2][j][k] = sg3[k][j];
    }
    SW[2] = { -0.562500, 0.520833333, 0.520833333, 0.520833333 };

    // SG(4,1:6,1-3), SW(4,1:6)
    double sg4[3][6] = {
        {0.81684757298, 0.09157621351, 0.09157621351, 0.1081030182, 0.4459484909, 0.4459484909},
        {0.09157621351, 0.81684757298, 0.09157621351, 0.4459484909, 0.10810301817, 0.4459484909},
        {0.09157621351, 0.09157621351, 0.81684757298, 0.4459484909, 0.4459484909, 0.1081030182}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 6; j++) SG[3][j][k] = sg4[k][j];
    }
    SW[3] = { 0.1099517436, 0.1099517436, 0.1099517436, 0.2233815897, 0.2233815897, 0.2233815897 };

    // SG(5,1:7,1-3),  SW(5,1:7)
    double sg5[3][7] = {
        {0.3333333333, 0.79742698535, 0.101286507323, 0.101286507323, 0.05971587179, 0.470142064105, 0.470142064105},
        {0.3333333333, 0.101286507323, 0.79742698535, 0.101286507323, 0.470142064105, 0.05971587179, 0.470142064105},
        {0.3333333333, 0.101286507323, 0.101286507323, 0.79742698535, 0.470142064105, 0.470142064105, 0.05971587179}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 7; j++) SG[4][j][k] = sg5[k][j];
    }
    SW[4] = { 0.225000000, 0.1259391805, 0.1259391805, 0.1259391805, 0.13239415279, 0.13239415279, 0.13239415279 };

    // SG(6,1:12,1-3), SW(6,1:12)
    double sg6[3][12] = {
        {0.873821971017, 0.063089014915, 0.063089014915, 0.50142650966, 0.24928674517, 0.24928674517,
            0.63650249912, 0.31035245103, 0.05314504985, 0.63650249912, 0.31035245103, 0.05314504985},
        {0.063089014915, 0.873821971017, 0.063089014915, 0.24928674517, 0.50142650966, 0.24928674517,
            0.31035245103, 0.63650249912, 0.63650249912, 0.05314504985, 0.05314504985, 0.31035245103},
        {0.063089014915, 0.063089014915, 0.873821971017, 0.24928674517, 0.24928674517, 0.50142650966,
            0.05314504985, 0.05314504985, 0.31035245103, 0.31035245103, 0.63650249912, 0.63650249912},
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 12; j++) SG[5][j][k] = sg6[k][j];
    }
    SW[5] = { 0.05084490637, 0.05084490637, 0.05084490637, 0.1167862757, 0.1167862757, 0.1167862757,
        0.08285107562, 0.08285107562, 0.08285107562, 0.08285107562, 0.08285107562, 0.08285107562 };

    // SG(7,1:13,1-3),  SW(7,1:13)
    double sg7[3][13] = {
        {0.3333333333, 0.4793080678, 0.2603459661, 0.2603459661, 0.8697397842, 0.0651301029, 0.0651301029,
            0.638444189, 0.638444189, 0.312865496, 0.312865496, 0.048690315, 0.048690315},
        {0.3333333333, 0.2603459661, 0.4793080678, 0.2603459661, 0.0651301029, 0.8697397842, 0.0651301029,
            0.312865496, 0.048690315, 0.638444189, 0.048690315, 0.638444189, 0.312865496},
        {0.3333333333, 0.2603459661, 0.260345966, 0.4793080678, 0.0651301029, 0.0651301029, 0.8697397842,
            0.048690315, 0.312865496, 0.048690315, 0.638444189, 0.312865496, 0.638444189}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 13; j++) SG[6][j][k] = sg7[k][j];
    }
    SW[6] = { -0.1495700444, 0.1756152574, 0.1756152574, 0.1756152574, 0.0533492356, 0.0533492356, 0.0533492356,
    0.0771137609, 0.0771137609, 0.0771137609, 0.0771137609, 0.0771137609, 0.0771137609 };

    // SG(8,1:16,1-3), SW(8,1:16)
    double sg8[3][16] = {
        {0.3333333333, 0.081414823, 0.459292588, 0.459292588, 0.6588613845, 0.1705693078, 0.1705693078,
            0.8989055434, 0.0505472283, 0.0505472283,
            0.0083947774, 0.0083947774, 0.2631128296, 0.2631128296, 0.7284923930, 0.7284923930},
        {0.3333333333, 0.459292588, 0.081414823, 0.459292588, 0.1705693078, 0.6588613845, 0.1705693078,
            0.0505472283, 0.8989055434, 0.0505472283,
            0.2631128296, 0.7284923930, 0.0083947774, 0.7284923930, 0.0083947774, 0.2631128296},
        {0.3333333333, 0.459292588, 0.459292588, 0.081414823, 0.1705693078, 0.1705693078, 0.6588613845,
            0.0505472283, 0.0505472283, 0.8989055434,
            0.7284923930, 0.2631128296, 0.7284923930, 0.0083947774, 0.2631128296, 0.0083947774}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 16; j++) SG[7][j][k] = sg8[k][j];
    }
    SW[7] = { 0.144315607677787,0.095091634267285, 0.095091634267285, 0.095091634267285,
            0.103217370534718, 0.103217370534718, 0.103217370534718 ,0.032458497623198, 0.032458497623198, 0.032458497623198 ,
            0.027230314, 0.027230314, 0.027230314, 0.027230314, 0.027230314, 0.027230314 };

    // SG(9,1:19,1-3), SW(9,1:19)
    double sg9[3][19] = {
        {0.333333333, 0.0206349616, 0.4896825192, 0.4896825192, 0.1258208170, 0.4370895915, 0.4370895915,
            0.6235929288, 0.1882035356, 0.1882035356, 0.9105409732, 0.0447295134, 0.0447295134,
            0.0368384121, 0.0368384121, 0.2219629892, 0.2219629892, 0.7411985988, 0.7411985988},
        {0.333333333, 0.4896825192, 0.0206349616, 0.4896825192, 0.4370895915, 0.1258208170, 0.4370895915,
            0.1882035356, 0.6235929288, 0.1882035356, 0.0447295134, 0.9105409732, 0.0447295134,
            0.2219629892, 0.7411985988, 0.0368384121, 0.7411985988, 0.0368384121, 0.2219629892},
        {0.333333333, 0.4896825192, 0.4896825192, 0.0206349616, 0.4370895915, 0.4370895915, 0.1258208170,
            0.1882035356, 0.1882035356, 0.6235929288, 0.0447295134, 0.0447295134, 0.9105409732,
            0.7411985988, 0.2219629892, 0.7411985988, 0.0368384121, 0.2219629892, 0.0368384121}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 19; j++) SG[8][j][k] = sg9[k][j];
    }
    SW[8] = { 0.097135796282799 ,
                0.031334700227139, 0.031334700227139, 0.031334700227139 ,
                0.077827541004774, 0.077827541004774, 0.07782754100477 ,
                0.079647738927210, 0.079647738927210, 0.079647738927210 ,
                0.025577675658698, 0.025577675658698, 0.025577675658698 ,
                0.0432835394, 0.0432835394, 0.0432835394, 0.0432835394, 0.0432835394, 0.0432835394 };

    // SG(10,1:25,1-3), SW(10,1:25)
    double sg10[3][25] = {
        {0.333333333, 0.0288447332, 0.4855776334, 0.4855776334, 0.7810368490, 0.1094815755, 0.1094815755,
            0.1417072194, 0.1417072194, 0.3079398388, 0.3079398388, 0.5503529418, 0.5503529418,
            0.02500353476, 0.02500353476, 0.24667256064, 0.24667256064, 0.72832390460, 0.72832390460,
            0.00954081540, 0.00954081540, 0.06680325101, 0.06680325101, 0.92365593358, 0.92365593358},
        {0.333333333, 0.4855776334, 0.0288447332, 0.4855776334, 0.1094815755, 0.7810368490, 0.1094815755,
            0.3079398388, 0.5503529418, 0.1417072194, 0.5503529418, 0.1417072194, 0.3079398388,
            0.24667256064, 0.72832390460, 0.02500353476, 0.72832390460, 0.02500353476, 0.24667256064,
            0.06680325101, 0.92365593358, 0.00954081540, 0.92365593358, 0.00954081540, 0.06680325101},
        {0.333333333, 0.4855776334, 0.4855776334, 0.0288447332, 0.1094815755, 0.1094815755, 0.7810368490,
            0.5503529418, 0.3079398388, 0.5503529418, 0.1417072194, 0.3079398388, 0.1417072194,
            0.72832390460, 0.24667256064, 0.72832390460, 0.02500353476, 0.24667256064, 0.02500353476,
            0.92365593358, 0.06680325101, 0.92365593358, 0.00954081540, 0.06680325101, 0.00954081540}
    };
    for (int k = 0; k < 3; k++) {
        for (int j = 0; j < 25; j++) SG[9][j][k] = sg10[k][j];
    }
    SW[9] = { 0.090817990382754 ,0.036725957756467, 0.036725957756467, 0.036725957756467 ,0.045321059435528, 0.045321059435528, 0.045321059435528 ,
                0.072757916845420, 0.072757916845420, 0.072757916845420, 0.072757916845420, 0.072757916845420, 0.072757916845420 ,
                0.028327242531057, 0.028327242531057, 0.028327242531057, 0.028327242531057, 0.028327242531057, 0.028327242531057 ,
                0.009421666963733, 0.009421666963733, 0.009421666963733, 0.009421666963733, 0.009421666963733, 0.009421666963733 };


    // Initialize VG，VW array
    VN = { 1, 4, 5, 11, 15, 0, 0 };

    VG[0][0][0] = 0.25;
    VG[0][0][1] = 0.25;
    VG[0][0][2] = 0.25;
    VG[0][0][3] = 0.25;
    VW[0] = { 1.0 };

    // VG(2,1:4,1-4), VW(2,1:4)
    double vg2[4][4] = {
        {0.58541020, 0.13819660, 0.13819660, 0.13819660},
        {0.13819660, 0.58541020, 0.13819660, 0.13819660},
        {0.13819660, 0.13819660, 0.58541020, 0.13819660},
        {0.13819660, 0.13819660, 0.13819660, 0.58541020}
    };
    for (int k = 0; k < 4; k++) {
        for (int j = 0; j < 4; j++) VG[1][j][k] = vg2[k][j];
    }
    VW[1] = { 0.25, 0.25, 0.25, 0.25 };

    // VG(3,1:5,1-4), VW(3,1:5)
    double vg3[4][5] = {
        {0.25, 0.50000000, 0.16777778, 0.16777778, 0.16777778},
        {0.25, 0.16777778, 0.50000000, 0.16777778, 0.16777778},
        {0.25, 0.16777778, 0.16777778, 0.50000000, 0.16777778},
        {0.25, 0.16777778, 0.16777778, 0.16777778, 0.50000000}
    };
    for (int k = 0; k < 4; k++) {
        for (int j = 0; j < 5; j++) VG[2][j][k] = vg3[k][j];
    }
    VW[2] = { -0.8, 0.45, 0.45, 0.45, 0.45 };

    // VG(4,1:11,1-4), VW(4,1:11)
    double vg4[4][11] = {
        {0.25, 0.78571429, 0.07142857, 0.07142857, 0.07142857,
            0.39940358, 0.39940358, 0.39940358, 0.10059642, 0.10059642, 0.10059642},
        {0.25, 0.07142857, 0.78571429, 0.07142857, 0.07142857,
            0.39940358, 0.10059642, 0.10059642, 0.39940358, 0.10059642, 0.39940358},
        {0.25, 0.07142857, 0.07142857, 0.78571429, 0.07142857,
            0.10059642, 0.39940358, 0.10059642, 0.10059642, 0.39940358, 0.39940358},
        {0.25, 0.07142857, 0.07142857, 0.07142857, 0.78571429,
            0.10059642, 0.10059642, 0.39940358, 0.39940358, 0.39940358, 0.10059642}
    };
    for (int k = 0; k < 4; k++) {
        for (int j = 0; j < 11; j++) VG[3][j][k] = vg4[k][j];
    }
    VW[3] = { -0.07893336, 
        0.045733332, 0.045733332, 0.045733332, 0.045733332 ,
                0.149333333, 0.149333333, 0.149333333, 0.149333333, 0.149333333, 0.149333333 };

    // VG(5,1:15,1-4), VW(5,1:15)
    double vg5[4][15] = {
        {0.25, 0.00000000, 0.33333333, 0.33333333, 0.33333333, 0.727272727, 0.090909091, 0.090909091, 0.090909091,
            0.06655015, 0.06655015, 0.06655015, 0.43349846, 0.43349846, 0.43349846},
        {0.25, 0.33333333, 0.00000000, 0.33333333, 0.33333333, 0.090909091, 0.727272727, 0.090909091, 0.090909091,
            0.06655015, 0.43349846, 0.43349846, 0.43349846, 0.06655015, 0.06655015},
        {0.25, 0.33333333, 0.33333333, 0.00000000, 0.33333333, 0.090909091, 0.090909091, 0.727272727, 0.090909091,
            0.43349846, 0.06655015, 0.43349846, 0.06655015, 0.43349846, 0.06655015},
        {0.25, 0.33333333, 0.33333333, 0.33333333, 0.00000000, 0.090909091, 0.090909091, 0.090909091, 0.727272727,
            0.43349846, 0.43349846, 0.06655015, 0.06655015, 0.06655015, 0.43349846 }
    };
    for (int k = 0; k < 4; k++) {
        for (int j = 0; j < 15; j++) VG[4][j][k] = vg5[k][j];
    }
    VW[4] = { 0.181702069, 0.036160714, 0.036160714, 0.036160714, 0.036160714, 0.069871495, 0.069871495, 0.069871495, 0.069871495 ,
                0.065694849, 0.065694849, 0.065694849, 0.065694849, 0.065694849, 0.065694849 };


}  // initialize_arrays function



// 阶乘计算函数（对应Fortran的ARR_MULTI）
int ARR_MULTI(int n) {
    if (n < 0) return 1;
    if (n == 0) return 1;

    int result = 1;
    for (int i = 1; i <= n; ++i) {
        result *= i;
    }
    return result;
}


void Ini_Gaussion() {
    initialize_arrays();

    for (int i = 0; i < 10; i++) {
        for (int j = 0; j < 10; j++) {
            AK[i][j] /= 2.0;
        }
    }

    for (int i = 0; i < 10; i++) {
        for (int j = 0; j < 10; j++) {
            U_NK[i][j] = (NK[i][j] + 1.0) / 2.0;
            S_NK[i][j] = sqrt(U_NK[i][j]);
            Q_NK[i][j] = pow(U_NK[i][j], 1.0 / 3.0);
        }

        int size = i + 1;
        T_AK[i].W.resize(size);
        for (int j = 0; j < size; ++j) {
            T_AK[i].W[j].resize(size);
        }

        // 填充W数组
        for (int j = 0; j <= i; ++j) {
            for (int k = 0; k <= i; ++k) {
                T_AK[i].W[j][k] = AK[i][j] * AK[i][k];
            }
        }
    }
}


